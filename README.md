# Application of a Novel Fuzzy Pattern Mining Algorithm for Sequence Data

For many Markov chains that arise in applications (health, finance, etc.), state spaces are huge, and existing matrix methods may not be practical or even not possible to implement. In the literature, the expected waiting time for Markov chains (with a smaller number of states) generated patterns are obtained by finding an appropriate pattern matrix and solving a set of linear equations. In this paper, a fuzzy transition probability (TP) matrix is introduced, and a data-driven fuzzy pattern mining algorithm is proposed for sequence data of any length. The proposed algorithm, which avoids the inversion of the pattern matrix, is applicable to Markov chains with huge state spaces.

The PDF copy of the paper can be downloaded from here: [Download Paper](https://ieeexplore.ieee.org/abstract/document/10633576) 

A preprint version of the paper is available in the repository.

Programming Language: [R](https://cran.r-project.org/bin/windows/base/) / [RStudio](https://posit.co/downloads/)

Data: The provided R codes download data directly from [Yahoo!Finance](https://ca.finance.yahoo.com/)

### Methodology



#### ðŸ”¹ Algorithm 1: Data-Driven Fuzzy Pattern Mining Algorithm for Categorical Sequences

**Input**:
Categorical sequence data with a finite state space.
Let \$k\$ be the number of distinct states.

**Steps**:

1. Identify the distinct elements of the state space.
2. Estimate the transition probability matrix \$\tilde{P}\$ using the R function `markovchainFit` from the R package `Markovchain`.
3. Construct a stochastic matrix \$A\$, where \$A\$ is a \$k \times k\$ matrix with
   $a_{ij} = \frac{1}{k} \quad \text{for each } i, j = 1, \ldots, k.$
4. Calculate the \$\alpha\$-cuts of \$\tilde{P}\$ using
   $P(\alpha) = \alpha A + (1 - \alpha)\tilde{P}, \quad \alpha \in [0, 1],$
   i.e.,
   $p_{ij}(\alpha) = \alpha a_{ij} + (1 - \alpha)\tilde{p}_{ij}.$
5. Simulate \$N\$ distinct sequences using the given states until the desired pattern first appears.
   Record the number of steps \$n\_l\$ (for \$l = 1, \ldots, N\$) required to reach the pattern in each simulation.
6. Calculate the expected waiting time by averaging the steps:
   $\frac{1}{N} \sum_{l=1}^{N} n_l.$


#### ðŸ”¹ Algorithm 2: Data-Driven Fuzzy Pattern Mining Algorithm for Numerical Sequences

**Input**:
Adjusted closing prices of stocks, indexes, or cryptocurrencies \$(S\_t, , t = 0, \ldots, n)\$.
Let \$k\$ be the number of distinct states.

**Steps**:

1. Compute log returns:
   $r_t = \log S_t - \log S_{t-1}, \quad t = 1, \ldots, n.$
2. Create a `signals` sequence where
   $\text{signals} = 1 \text{ if } r_t \geq 0,\ \text{otherwise } -1.$
3. Estimate the transition probability matrix \$\tilde{P}\$ using the R function `markovchainFit` from the R package `Markovchain`.
4. Construct a stochastic matrix \$A\$, where \$A\$ is a \$k \times k\$ matrix with
   $a_{ij} = \frac{1}{k} \quad \text{for each } i, j = 1, \ldots, k.$
5. Calculate the \$\alpha\$-cuts of \$\tilde{P}\$ using
   $P(\alpha) = \alpha A + (1 - \alpha)\tilde{P}, \quad \alpha \in [0, 1],$
   i.e.,
   $p_{ij}(\alpha) = \alpha a_{ij} + (1 - \alpha)\tilde{p}_{ij}.$
6. Simulate \$N\$ distinct sequences using the given states until the desired pattern first appears.
   Record the number of steps \$n\_l\$ (for \$l = 1, \ldots, N\$) required to reach the pattern in each simulation.
7. Calculate the expected waiting time by averaging the steps:
   $\frac{1}{N} \sum_{l=1}^{N} n_l.$


### Findings

The driving idea, unlike the existing work, is that the resilient pattern mining algorithm is obtained by fuzzifying the transition probability matrix. Three applications (DNA sequence data, patterns generated by the log returns of the cryptocurrencies, and a Markov chain model for network security) of the proposed algorithm are discussed in detail. The main contribution of this work is to fit an appropriate Markov chain model to a given data sequence and  use the proposed fuzzy pattern mining algorithm to obtain resilient probabilistic forecasts and expected waiting time for patterns.

